---
layout: post
current: post
cover:  assets/built/images/develop/develop-1.jpg
navigation: True
title: JPA 연관관계가 왜 중요한가?
date: 2021-01-25 16:40:00
tags: [develop]
class: post-template
subclass: 'post tag-java'
author: joo-pe
---

{% include develop-table-of-contents.html %}


JPA의 연관관계

## 연관관계

데이터베이스와 어플리케이션 사이에 메모리 캐쉬를 이용하여 테이블을 객체지향적으로 처리할 수 있도록 하는게 JPA의 핵심이다.
테이블들을 객체로 보는 것이 ORM의 핵심이다. 각각의 테이블을 객체로 보고, 사용되는 객체 연관관계도 객체지향적으로 연결시켜 놓으면 JPA의 장점을 활용할 수 있다.

엔티티의 관계에는 1:N, N:1, M:N 의 관계로 볼 수 있다.
연관관계에 대해 객체화 시켜놓은 테이블이 서로 참조할 수 있도록 클래스를 구현할 때 선언 해 놓는 것이 필요하다.

_팀과 회원이 있다고 하면 *1:N* 의 관계가 된다._ 

이 경우를 클래스로 구현하게 되면

팀에 속한 여러 회원을 구현할 수 있으므로, 회원에서 팀을 포함하고 있어야 한다.
이렇게되려면 *단방향* 이 되어야 한다.
팀은 여러 객체에서 사용될 수 있기 때문에 의존적이지 않고, 여러 팀에 속할 수 있는 회원 객체에서 팀을 선언한다.
따라서 팀에서는 회원을 선언하지 않기 때문에 회원에 대해 알지 못한다.

Team을 참조하고 있는 member 테이블에서 다음과 같이 선언한다.

~~~java
@ManyToOne
@JoinColumn(name="TEAM_ID")
private Team team;
~~~

### 주인이란?

외래키를 가지고 있는 테이블이 주인이 있다. 다대일 이라고 하면 다에서 외래키를 관리하고 주인이라고 한다.
주인을 명하는 이유는 키를 한곳에서만 관리하자는 측면을 위해서 있는 개념이다.
주인인 곳에서는 mappedBy 속성을 사용하지 않는다.

![img.png2](assets/built/images/develop/img02.png)

방향성에는 단방향과 양방향이 있는데, 단방향은 한쪽 참조라면 보고,
양방향이 헤갈릴 수도 있는데
데이터베이스 상에서는 방향이 없다. 외래키 하나만 설정하면 된다. 
**ORM 에서는 참조 여부를 방향이라고 일컫는다.**
양쪽에서 모두 참조하면 양방향이 되는 것이다.

일대다 관계에서는 하나 이상을 참조할 수 있으므로 컬렉션인 Collection, List, Set,Map 중 하나를 사용할 수 있다.

일대다 단방향 매핑 보다는 다대일 양방향 매핑이 좋다.
일대다 단방향 매핑인경우 본인 테이블에 외래키가 없어 update 등의 문제가 발생할 수 있다.





